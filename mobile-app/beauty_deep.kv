#:import AKSilverAppbar akivymd.uix.silverappbar
#:import AKSilverAppbarContent akivymd.uix.silverappbar
#:import AKSilverAppbarHeader akivymd.uix.silverappbar


<MainInterface>:
	toolbar: toolbar
	bottom_panel: bottom_panel

	menu_screen: menu_screen
	home_screen: home_screen
	image_screen: image_screen
	settings_screen: settings_screen
	spinner_screen: spinner_screen
	beauty_screen: beauty_screen

	Screen:
		id: menu_screen
		name: 'menu_screen'

		MenuScreen:
			orientation:'vertical'

			MDToolbar:
				id: toolbar
				title: 'BeautyDeep'
				right_action_items: [['images/logo.png', lambda x: None]]
				
			MDBottomNavigation:
				id: bottom_panel

				HomeScreen:
					id: home_screen
					name: 'home_screen'
					icon: 'home-variant'

					home_content: home_content

					ScrollView:
						MDGridLayout:
							id: home_content
							cols: 1
							adaptive_height: True

				ImageScreen:
					id: image_screen
					name: 'image_screen'
					icon: 'plus-circle-outline'
					on_tab_release: app.file_manager_open()

					MDIconButton:
						icon: 'image-plus'
						pos_hint: {'center_x': .5, 'center_y': .5}
						user_font_size: dp(256)
						theme_text_color: 'Custom'
						text_color: app.theme_cls.primary_color
						on_release: app.file_manager_open()

				SettingsScreen:
					id: settings_screen
					name: 'settings_screen'
					icon: 'cog-outline'  

					light_label: light_label
					dark_label: dark_label
					style_label: style_label
					color_label: color_label
					language_label: language_label
					server_label: server_label
					about_label: about_label
					developer_label: developer_label
					feedback_label: feedback_label
					social_label: social_label
					share_label: share_label
					rate_label: rate_label
					lang_chooser: lang_chooser

					ScrollView:
						MDGridLayout:
							adaptive_height: True
							cols: 1
							padding: dp(15)
							spacing: dp(10)

							MDLabel:
								id: style_label
								bold: True
								theme_text_color: 'Primary'

							MDBoxLayout:
								size_hint: None, None
								adaptive_size: True
								spacing: dp(30)

								MDCheckbox:
									group: 'style'
									size_hint: None, None
									size: dp(48), dp(48)
									active: True if app.theme_cls.theme_style == 'Light' else False
									on_active: if self.active and app.theme_cls.theme_style == 'Dark': app.switch_theme_style()

								Label:
									id: light_label
									color: app.theme_cls.text_color

								MDCheckbox:
									group: 'style'
									size_hint: None, None
									size: dp(48), dp(48)
									active: True if app.theme_cls.theme_style == 'Dark' else False
									on_active: if self.active and app.theme_cls.theme_style == 'Light': app.switch_theme_style()

								Label:
									id: dark_label
									color: app.theme_cls.text_color

							MDSeparator:

							MDLabel:
								id: color_label
								bold: True
								theme_text_color: 'Primary'
								size_hint_y: None
								height: self.texture_size[1]

							MDGridLayout:
								adaptive_height: True
								cols: 5
								row_default_height: root.height * .1
								col_default_width: root.width * .15
								row_force_default: True
								col_force_default: True
								center: root.width / 2, root.height / 2

								MDIconButton:
									icon: 'water'
									theme_text_color: 'Custom'
									text_color: root.settings_screen.theme_colors['Red']
									user_font_size: dp(30)
									on_release: app.switch_theme_color('Red')
								MDIconButton:
									icon: 'water'
									theme_text_color: 'Custom'
									text_color: root.settings_screen.theme_colors['Pink']
									user_font_size: dp(30)
									on_release: app.switch_theme_color('Pink')
								MDIconButton:
									icon: 'water'
									theme_text_color: 'Custom'
									text_color: root.settings_screen.theme_colors['Purple']
									user_font_size: dp(30)
									on_release: app.switch_theme_color('Purple')
								MDIconButton:
									icon: 'water'
									theme_text_color: 'Custom'
									text_color: root.settings_screen.theme_colors['DeepPurple']
									user_font_size: dp(30)
									on_release: app.switch_theme_color('DeepPurple')
								MDIconButton:
									icon: 'water'
									theme_text_color: 'Custom'
									text_color: root.settings_screen.theme_colors['Indigo']
									user_font_size: dp(30)
									on_release: app.switch_theme_color('Indigo')
								MDIconButton:
									icon: 'water'
									theme_text_color: 'Custom'
									text_color: root.settings_screen.theme_colors['Blue']
									user_font_size: dp(30)
									on_release: app.switch_theme_color('Blue')
								MDIconButton:
									icon: 'water'
									theme_text_color: 'Custom'
									text_color: root.settings_screen.theme_colors['Cyan']
									user_font_size: dp(30)
									on_release: app.switch_theme_color('Cyan')
								MDIconButton:
									icon: 'water'
									theme_text_color: 'Custom'
									text_color: root.settings_screen.theme_colors['Teal']
									user_font_size: dp(30)
									on_release: app.switch_theme_color('Teal')
								MDIconButton:
									icon: 'water'
									theme_text_color: 'Custom'
									text_color: root.settings_screen.theme_colors['Green']
									user_font_size: dp(30)
									on_release: app.switch_theme_color('Green')
								MDIconButton:
									icon: 'water'
									theme_text_color: 'Custom'
									text_color: root.settings_screen.theme_colors['LightGreen']
									user_font_size: dp(30)
									on_release: app.switch_theme_color('LightGreen')
								MDIconButton:
									icon: 'water'
									theme_text_color: 'Custom'
									text_color: root.settings_screen.theme_colors['Lime']
									user_font_size: dp(30)
									on_release: app.switch_theme_color('Lime')
								MDIconButton:
									icon: 'water'
									theme_text_color: 'Custom'
									text_color: root.settings_screen.theme_colors['Yellow']
									user_font_size: dp(30)
									on_release: app.switch_theme_color('Yellow')
								MDIconButton:
									icon: 'water'
									theme_text_color: 'Custom'
									text_color: root.settings_screen.theme_colors['Amber']
									user_font_size: dp(30)
									on_release: app.switch_theme_color('Amber')
								MDIconButton:
									icon: 'water'
									theme_text_color: 'Custom'
									text_color: root.settings_screen.theme_colors['Orange']
									user_font_size: dp(30)
									on_release: app.switch_theme_color('Orange')
								MDIconButton:
									icon: 'water'
									theme_text_color: 'Custom'
									text_color: root.settings_screen.theme_colors['DeepOrange']
									user_font_size: dp(30)
									on_release: app.switch_theme_color('DeepOrange')

							MDSeparator:

							MDLabel:
								id: language_label
								bold: True
								theme_text_color: 'Primary'
								size_hint_y: None
								height: self.texture_size[1]

							MDDropDownItem:
								id: lang_chooser
								pos_hint: {'center_x': .5, 'center_y': .5}
								on_release: root.settings_screen.language_menu.open()

							MDSeparator:

							MDLabel:
								id: server_label
								bold: True
								theme_text_color: 'Primary'
								size_hint_y: None
								height: self.texture_size[1]

							MDTextField:
								id: server_field
								text: app.server_ip
								helper_text: 'http://public_ip:port or http://domain.com'
								helper_text_mode: 'on_focus'
								color_mode: 'custom'
								line_color_focus: app.theme_cls.text_color
								on_text_validate: app.change_server_ip(server_field.text)

							MDSeparator:

							MDLabel:
								id: about_label
								bold: True
								theme_text_color: 'Primary'
								size_hint_y: None
								height: self.texture_size[1]

							OneLineIconListItem:
								id: developer_label
								on_release: root.settings_screen.create_dev_dialog()
								IconLeftSampleWidget:
									on_release: root.settings_screen.create_dev_dialog()
									icon: 'dev-to'

							OneLineIconListItem:
								id: feedback_label
								on_release: root.settings_screen.feedback('https://t.me/TheKiryu')
								IconLeftSampleWidget:
									icon: 'forum'
									on_release: root.settings_screen.feedback('https://t.me/TheKiryu')

							MDSeparator:

							MDLabel:
								id: social_label
								bold: True
								theme_text_color: 'Primary'
								size_hint_y: None
								height: self.texture_size[1]

							OneLineIconListItem:
								id: share_label
								on_release: root.settings_screen.create_share_dialog()
								IconLeftSampleWidget:
									icon: 'share-variant'
									on_release: root.settings_screen.create_share_dialog()

							OneLineIconListItem:
								id: rate_label
								on_release: root.settings_screen.create_rate_dialog()
								IconLeftSampleWidget:
									icon: 'star'
									on_release: root.settings_screen.create_rate_dialog()

							Widget:
								size_hint_y: None
								height: app.theme_cls.standard_increment

	Screen:
		name: 'spinner_screen'

		SpinnerScreen:
			id: spinner_screen
			orientation:'vertical'

			processing_label1: processing_label1
			processing_label2: processing_label2

			MDToolbar:
				id: toolbar
				title: 'BeautyDeep'
				right_action_items: [['images/logo.png', lambda x: None]]

			MDLabel:
				id: processing_label1
				halign: 'center'
				valign: 'bottom'

			MDSpinner:
				size_hint: None, None
				size: dp(55), dp(55)
				pos_hint: {'center_x': .5, 'top': 0}
				active: True

			MDLabel:
				id: processing_label2
				halign: 'center'
				valign: 'bottom'

	BeautyScreen:
		id: beauty_screen
		name: 'beauty_screen'
		
		score: score
		image: image

		eyes_param: eyes_param
		brows_param: brows_param
		nose_param: nose_param
		lips_param: lips_param
		chin_param: chin_param
		face_param: face_param
		smile_param: smile_param
		ratio_param: ratio_param
		symmetry_param: symmetry_param
		rotation_param: rotation_param
		character_param: character_param
		beauty_peacenatge: beauty_peacenatge

		piechart_box: piechart_box
		face_selection_button: face_selection_button
		save_button: save_button
		mask_button: mask_button

		FloatLayout:
			AKSilverAppbar:
				id: score
				max_height: dp(300)
				left_action_items: [['arrow-left', lambda x: app.set_current_screen('menu_screen')]]
				right_action_items: [['images/logo.png', lambda x: None]]
				pin_top: True
				hide_toolbar: False
				radius: dp(20)
				toolbar_bg: app.theme_cls.primary_color
					
				AKSilverAppbarHeader:  
					orientation: 'vertical' 
					padding: [dp(0), dp(50), dp(0), dp(0)]
					Image:
						id: image
						source: 'images/default.jpg'
						allow_stretch: True 
						keep_ratio: True

				AKSilverAppbarContent:
					padding: [dp(4), dp(10), dp(4), dp(10)]
					spacing: dp(10)
					size_hint_y: None 
					height: self.minimum_height
					orientation: 'vertical'
					md_bg_color: .27, .84, 1, 1

					BoxLayout:
						orientation: 'vertical'
						padding: [dp(4), dp(10), dp(4), dp(10)]
						size_hint_y: None
						height: self.minimum_height

						BoxLayout:
							size_hint_y: None
							height: self.minimum_height

							Widget:
							MDFillRoundFlatButton:
								id: save_button
								text_color: 0, 0, 0, 1
								on_release: root.beauty_screen.save_results()
							Widget:
							Widget:
							MDFillRoundFlatButton:
								id: mask_button
								text_color: 0, 0, 0, 1
								on_release: root.beauty_screen.display_mask()
							Widget:

						OneLineIconListItem:
							id: eyes_param
							ImageLeftWidget:
								source: 'images/eyes.png'

						OneLineIconListItem:
							id: brows_param
							ImageLeftWidget:
								source: 'images/eyebrows.png'

						OneLineIconListItem:
							id: nose_param
							ImageLeftWidget:
								source: 'images/nose.png'

						OneLineIconListItem:
							id: lips_param
							ImageLeftWidget:
								source: 'images/lips.png'

						OneLineIconListItem:
							id: chin_param
							ImageLeftWidget:
								source: 'images/chin.png'

						OneLineIconListItem:
							id: face_param
							ImageLeftWidget:
								source: 'images/face.png'

						OneLineIconListItem:
							id: smile_param
							ImageLeftWidget:
								source: 'images/smile.png'

						OneLineIconListItem:
							id: ratio_param
							ImageLeftWidget:
								source: 'images/ratio.png'

						OneLineIconListItem:
							id: symmetry_param
							ImageLeftWidget:
								source: 'images/symmetry.png'

						OneLineIconListItem:
							id: rotation_param
							ImageLeftWidget:
								source: 'images/rotation.png'

						OneLineIconListItem:
							id: character_param
							ImageLeftWidget:
								source: 'images/character.png'

						MDBoxLayout:
							id: piechart_box
							adaptive_height: True 
							spacing: dp(40)
							padding: [dp(0), dp(40), dp(0), dp(0)]
							orientation: 'vertical'

							MDLabel:
								id: beauty_peacenatge
								halign: 'center'

			MDFloatingActionButton:
				id: zoom_button
				icon: 'magnify-plus-outline'
				size_hint: None, None
				size: dp(55), dp(55)
				pos_hint: {'right': .95, 'y': .15}
				md_bg_color: app.theme_cls.primary_color
				on_release: root.beauty_screen.image_viewer.open()

			MDFloatingActionButton:
				id: face_selection_button
				icon: 'face-recognition'
				size_hint: None, None
				size: dp(55), dp(55)
				pos_hint: {'right': .95, 'y': .05}
				md_bg_color: app.theme_cls.primary_color
				on_release: root.beauty_screen.face_menu.open()


<DeveloperDialog>:
	id: developer_dialog

	dialog_title: dialog_title
	developer_name: developer_name

	size_hint: None, None
	height: Window.height * 0.4
	width: Window.width * 0.9
	canvas:
		Color:
			rgba: app.theme_cls.bg_dark
		RoundedRectangle:
			pos: self.pos
			size: self.size
			radius: [15,]

	BoxLayout:
		orientation: 'vertical'
		padding: dp(10)
		spacing: dp(10)

		MDLabel:
			id: dialog_title
			halign: 'center'
			theme_text_color: 'Custom'
			text_color: app.theme_cls.primary_color
			font_style: 'H4'
			bold: True
			size_hint_y: None
			height: self.texture_size[1]

		MDSeparator:

		ScrollView:
			MDGridLayout:
				cols: 1
				adaptive_height: True

				ThreeLineAvatarListItem:
					id: developer_name
					secondary_text: 'https://github.com/Defaultin'
					tertiary_text: 'klimenko.kirill.01@gmail.com'
					on_release: root.web_reference('https://github.com/Defaultin')
					ImageLeftWidget:
						source: 'images/developer.png'